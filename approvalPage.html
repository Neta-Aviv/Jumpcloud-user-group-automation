<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h3>Processing your approval...</h3>
    <script>
      const row = <?= row ?>;

      google.script.run
        .withSuccessHandler(() => {
          document.body.innerHTML = "<h2>✅ Request approved successfully!</h2>";
        })
        .withFailureHandler(err => {
          document.body.innerHTML = `<h2>❌ Error:</h2><pre>${err.message}</pre>`;
        })
        .approveRequestFromClient(row);
    </script>
  </body>
</html>
